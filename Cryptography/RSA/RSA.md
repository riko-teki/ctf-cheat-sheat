# RSA暗号

## RSA暗号の基礎
- 公開鍵暗号
- 桁数の大きい合成数の素因数分解が困難であることが安全性の根拠

## 鍵生成の手順
1. 大きな異なる素数、p,qを選択し、$n = p * q$とする
1. $φ(n) = (p - 1)(q - 1)$とする(オイラー関数)
1. $1 < e < n$の範囲でφ(n)と素になるeを選択する(eのベストは65537)
1. {e, n} を公開鍵として公開する
1. $d =e^{-1} \ mod \ lcm(p - 1, q - 1)$を満たすdを選択する
1. p,q,dは秘密鍵として秘匿しておく

## 暗号化
$c = m^e \ mod \ n$

## 復号
$m = c^d \ mod \ n$

## RSA暗号におけるバッドプラクティス

### 公開鍵$n$のビット数が小さい
$n$が小さいと素因数分解が可能
1024bit以下なら疑え

### $p,q$の片方が小さい値
$n$を小さい素数から順に割っていく事で素因数分解が可能

### $p,q$の値が近い
$p,q$の値が近いと、それらの値が$n$の平方根の周辺に限定される

### $p,q$が有名な素数(メルセンヌ素数等)
メルセンヌ素数 => $2^n - 1$(nは自然数)<br>
メルセンヌ素数は49個しか見つかっていないので総当たりが可能

### 公開鍵$n$の生成時に同じ素数を使いまわしている
$n = p * q$ かつ $n' = p * r$のとき、$n$と$n'$の公約数を計算することでpが求まる

### $e$の値が小さすぎる
***Low Public Exponent Attck***が刺さる<br>
$e$ と $n$が共に小さく($e = 3$等)、$m^e < n$のとき、$c$の$e$乗根を計算することで$m$が求まる

### $e$の値が大きすぎる
***Wiener's Atack***が刺さる<br>
$e$が大きいと$d$が相対的に小さくなることを利用

### 同一の平文を異なる$e$で暗号化した暗号文が取得できる
***Common Modulus Attack***が刺さる<br>
$m,n$が共通で$e$が異なる$e,c$の組があるとき、***拡張ユークリッドの互除法***を用いて$m$を計算可能

### 同一の平文を異なる$n$で暗号化した暗号文が取得できる
***Håstad's Broadcast Attack***が刺さる<br>
同一の$m$を異なる$n$で暗号化した$c$が$e$個得られるとき***中国剰余定理***を用いて$m$を計算可能

### 任意の$c$を復号した結果の偶奇(下位1bit)が取得できる
***LSB Decryption Oracle Attack***が刺さる<br>
$c$に対して$m$の偶奇が分かるとき、***二分探索***によって$m$を計算可能

### 上位ビットが共つする二つの平文に対する暗号文を取得できる
***Franklin-Reiter Related Message Attack***が刺さる<br>
二つの平文$m1, m2 = a * m1 + b$と、それぞれの暗号文が得られる時、$m1$が計算可能

### 素数$p$の上位ビット、または下位ビットが取得できる
***Coppersmith's Attack***が刺さる<br>
***Coppoersmithの定理***を用いて$p$の一部の情報($p$のビット数の1/2程度)から$p$を特定できる

### 秘密鍵$d$の下位ビットが取得できる
***Coppersmith's Attack(Partial Key Exposure Attack)***が刺さる<br>
***Coppoersmithの定理***を用いて$d$の一部の情報($p$のビット数の1/4程度)から$d$を特定できる

### 平文$m$の上位ビット、または下位ビットが取得できる
***Coppersmith's Attack***が刺さる<br>
***Coppoersmithの定理***を用いて$m$の一部の情報($m$のビット数の$1 - 1/e$程度)から$m$を特定できる


### And more...
- RSA-CRT Fault Attack
- 適応的選択暗号文攻撃
- Coppersmith's Short Pad Attack
- Boneh-Durfee Attack
- 乱数生成器の偏りを利用した攻撃
...












